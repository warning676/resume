class Utils{static debounce(e,t){let n;return function(...l){clearTimeout(n),n=setTimeout(()=>e.apply(this,l),t)}}static formatFullDate(e){if(!e)return"";return new Date(e.replace(/-/g,"/")).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}static getProficiencyValue(e){return{Advanced:3,Intermediate:2,Beginner:1}[e]||0}static extractYouTubeID(e){if(!e)return"";if(!/[:/\.]/.test(e))return e.trim();const t=[/(?:youtube\.com\/shorts\/)([a-zA-Z0-9_-]{11})/,/(?:youtube\.com\/watch\?v=)([a-zA-Z0-9_-]{11})/,/(?:youtu\.be\/)([a-zA-Z0-9_-]{11})/,/(?:youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/,/^([a-zA-Z0-9_-]{11})$/];for(const n of t){const t=e.match(n);if(t&&t[1])return t[1]}return e.trim()}}class DataService{constructor(e){this.spreadsheetId=e}convertGoogleDriveUrl(e){if(!e)return null;if(!e.includes("drive.google.com"))return e;const t=e.match(/\/d\/([a-zA-Z0-9_-]+)/);if(t){return`https://lh3.google.com/d/${t[1]}=w1200`}return e}normalizePath(e,t){return e?(e=e.replace(/\\/g,"/"),"videos"===t?e=e.replace(/Images\/Videos\//i,"Images/videos/"):"games"===t&&(e=e.replace(/Images\/Games\//i,"Images/games/")),e):e}parseAwards(e){if(!e)return[];const t=[],n=e.split(",");for(const e of n){const n=e.trim();if(!n)continue;const l=n.match(/Award:\s*([^|]+)/),a=n.match(/Location:\s*(.+?)\s*\|\s*Date:/),s=n.match(/Date:\s*(.+)$/);l&&a&&s&&t.push({award:l[1].trim(),location:a[1].trim(),date:s[1].trim().toUpperCase()})}return t}buildFilmFestivalAwards(e){const t={};return Array.isArray(e)?(e.forEach(e=>{e.name&&Array.isArray(e.awards)&&e.awards.length>0&&(t[e.name]=e.awards)}),t):t}async fetchLastUpdated(){const e=document.getElementById("last-updated-date");if(!e)return;let t=null;try{t=localStorage.getItem("lastUpdatedOnGithub")||null}catch(e){t=null}t&&(e.textContent=t);try{const n=await fetch("https://api.github.com/repos/warning676/resume/commits/main"),l=await n.json(),a=new Date(l.commit.committer.date).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});if(a===t)return;e.textContent=a;try{localStorage.setItem("lastUpdatedOnGithub",a)}catch(e){}}catch(n){t||(e.textContent="Recently")}}updateCurrentTime(){const e=document.getElementById("current-time");if(!e)return;const t=new Date;e.textContent=t.toLocaleString("en-US",{timeZone:"America/Los_Angeles",weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}startTimeUpdates(){this.updateCurrentTime(),setInterval(()=>this.updateCurrentTime(),6e4)}async loadSheet(e){const t=`sheet_${e}`,n=`sheet_${e}_ts`;try{const e=localStorage.getItem(t),l=localStorage.getItem(n);if(e&&l&&Date.now()-parseInt(l)<36e5)return{data:JSON.parse(e),fromCache:!0}}catch(e){}try{const l=`https://docs.google.com/spreadsheets/d/${this.spreadsheetId}/gviz/tq?tqx=out:json&sheet=${e}`,a=await fetch(l);if(!a.ok)throw new Error(`Could not fetch ${e} sheet`);const s=await a.text(),r=this.parseGVizResponse(s,e);try{localStorage.setItem(t,JSON.stringify(r)),localStorage.setItem(n,String(Date.now()))}catch(e){}return{data:r,fromCache:!1}}catch(e){throw e}}async loadAllData(){const e=["videos","games","skills"],t={};let n=!0;try{for(const l of e){const e=await this.loadSheet(l);t[l]=e.data,e.fromCache||(n=!1)}return{data:t,allCached:n}}catch(e){throw e}}parseGVizResponse(e,t=""){const n=e.match(/google\.visualization\.Query\.setResponse\(([\s\S]*)\);/);if(!n)return[];const l=JSON.parse(n[1]).table,a={Name:"name",Badge:"badge",Date:"date",Info:"info",Tools:"tools","YouTube Link":"youtube",Gallery:"gallery",Awards:"awards",Level:"level","Last Used":"lastUsed",Icon:"icon","Certified Status":"certified","Certification Name":"certName"},s=l.cols.map(e=>a[e.label]||e.label.toLowerCase());return l.rows.map(e=>{const n={};return e.c.forEach((e,l)=>{const a=s[l];if(!a)return;let r=e?e.v:null;if("gallery"===a&&r){const e=r.includes(",")?",":" ";r=r.split(e).map(e=>{const n=e.trim();if(!n)return null;if(n.startsWith("http"))return n;let l=this.normalizePath(n,t);return l.startsWith("http")||l.startsWith("../")||l.startsWith("Images/")||("games"===t?l=`Images/games/${l}`:"videos"===t&&(l=`Images/videos/${l}`)),l}).filter(e=>e)}else"date"===a||"lastUsed"===a?r=e&&e.f?e.f:r:"certified"===a&&e?r=!0===e.v||"TRUE"===String(e.f).toUpperCase():"icon"===a&&r&&"string"==typeof r?r=this.convertGoogleDriveUrl(r):"awards"===a&&r&&"string"==typeof r&&(r=this.parseAwards(r));n[a]=r}),n})}}class ModalManager{constructor(e){this.s=e,this.galleryLoadId=0}fixImagePath(e){if(!e)return e;if(e.startsWith("http")||e.startsWith("data:")){if(e.includes("drive.google.com")&&!e.includes("lh3.google.com")){const t=e.match(/\/d\/([a-zA-Z0-9_-]+)/);if(t)return`https://lh3.google.com/d/${t[1]}=w1200`}return e}return e.startsWith("../")?e:"../"+e}delay(e){return new Promise(t=>setTimeout(t,e))}preloadImage(e,t){return new Promise(n=>{if(!e)return void n({ok:!1,src:"",cached:!1});const l=new Image,a=Date.now();let s=!1;const r=(t,l)=>{if(s)return;s=!0,clearTimeout(o);const r=Date.now()-a;n({ok:t,src:l||e,cached:t&&r<50})},o=setTimeout(()=>r(!1,e),t||3e3);l.onload=()=>r(!0,e),l.onerror=()=>r(!1,e),l.src=e})}buildGallerySkeletons(e,t){if(!e||t<=0)return;e.innerHTML="";for(let n=0;n<t;n++)e.insertAdjacentHTML("beforeend",'<div class="gallery-skeleton"></div>')}ensureGalleryControls(e){if(!e)return{gPrev:null,gNext:null,wrapper:null};if(e.parentElement&&e.parentElement.classList.contains("gallery-container-wrapper")){const t=e.parentElement;return{gPrev:t.querySelector(".gallery-nav-btn.prev"),gNext:t.querySelector(".gallery-nav-btn.next"),wrapper:t}}const t=document.createElement("button");t.id="gallery-prev",t.className="gallery-nav-btn prev",t.innerHTML="&#10094;";const n=document.createElement("button");n.id="gallery-next",n.className="gallery-nav-btn next",n.innerHTML="&#10095;";const l=document.createElement("div");return l.className="gallery-container-wrapper",e.parentNode.insertBefore(l,e),l.appendChild(t),l.appendChild(e),l.appendChild(n),{gPrev:t,gNext:n,wrapper:l}}applyGalleryState(){const e=this.s,t=e.galleryEl,n=e.galleryWrapper,l=e.galleryToggleEl,a=e.galleryTargetModal,s=!!e.galleryCollapsed,r=!!e.canToggleGallery;return a&&a.classList.toggle("gallery-collapsed",s),l&&(l.style.display=r?"":"none",l.setAttribute("aria-expanded",s?"false":"true"),l.setAttribute("aria-label",s?"Show gallery":"Hide gallery")),r?e.galleryHasRendered?(t&&(t.style.display=""),void(n&&(n.style.display=""))):(a&&a.classList.toggle("gallery-collapsed",s),t&&(t.style.display=""),n&&(n.style.display=""),void(e.galleryHasRendered=!0)):(t&&(t.style.display="none"),void(n&&(n.style.display="none")))}resetModal(){const e=this.s;e.modal&&(e.modal.style.display="none"),e.videoFrame&&(e.videoFrame.src="");const t=document.getElementById("big-image-view");t&&t.remove();const n=document.querySelector(".modal-body-split");n&&(n.scrollTop=0);const l=document.querySelector(".modal-content");l&&(l.scrollTop=0);const a=document.getElementById("modal-gallery");a&&(a.scrollLeft=0),e.modal&&e.modal.classList.remove("gallery-collapsed"),e.galleryCollapsed=!1,e.canToggleGallery=!1,e.galleryHasRendered=!1,e.galleryEl=null,e.galleryWrapper=null,e.galleryToggleEl=null,e.galleryTargetModal=null,e.currentItemCard=null;try{document.body.style.overflow=""}catch(e){}try{const t=e.modal?e.modal.querySelector(".modal-content"):null;t&&t.classList.remove("no-side-padding")}catch(e){}}resetSecModal(){const e=this.s;e.secModal&&(e.secModal.style.display="none"),e.currentToolsContext=[],e.currentToolIndex=-1;try{document.body.style.overflow=""}catch(e){}try{const t=e.secModal?e.secModal.querySelector(".modal-content"):null;t&&t.classList.remove("no-side-padding")}catch(e){}}showVideo(e,t=!1){const n=this.s,l=document.getElementById("big-image-view");l&&l.remove(),n.videoFrame&&(n.videoFrame.style.display="block",n.videoFrame.src=`https://www.youtube.com/embed/${e}`),n.mediaContainer&&(t?(n.mediaContainer.style.paddingBottom="177.78%",n.mediaContainer.style.maxWidth="400px",n.mediaContainer.style.margin="0 auto"):(n.mediaContainer.style.paddingBottom="56.25%",n.mediaContainer.style.maxWidth="",n.mediaContainer.style.margin=""))}showImage(e){const t=this.s;t.videoFrame&&(t.videoFrame.style.display="none",t.videoFrame.src="");const n=document.getElementById("big-image-view");n&&n.remove();const l=document.querySelector(".media-skeleton");l&&l.remove();const a=document.createElement("img");a.id="big-image-view",a.src=this.fixImagePath(e),t.mediaContainer&&t.mediaContainer.appendChild(a)}navigateItem(e){const t=this.s,n=t.modal&&t.modal.classList.contains("modal-skill");if(t.isAchievementsPage&&!n&&t.achievementVideos&&t.achievementVideos.length>1){const n=t.currentAchievementVideoIndex;if(n<0)return;const l=(n+e+t.achievementVideos.length)%t.achievementVideos.length;t.currentAchievementVideoIndex=l;const a=t.achievementVideos[l];return void(a&&this.openModalForItem(a))}if(!t.currentItemCard)return;let l,a;if(t.isSkillsPage||t.isAchievementsPage&&n)l=t.skillsList,a=".skill-item";else{if(!t.isPortfolioPage)return void t.isAchievementsPage;l=t.portfolioGrid,a=".portfolio-card"}const s=Array.from(l.querySelectorAll(a)).filter(e=>"none"!==e.style.display);if(s.length<=1)return;const r=(s.indexOf(t.currentItemCard)+e+s.length)%s.length;t.currentItemCard=s[r],this.openModalForItem(t.currentItemCard)}navigateTool(e){const t=this.s;if(!t.currentToolsContext.length)return;t.currentToolIndex=(t.currentToolIndex+e+t.currentToolsContext.length)%t.currentToolsContext.length;const n=t.currentToolsContext[t.currentToolIndex],l=t.allData&&t.allData.skills?t.allData.skills.find(e=>e.name.toLowerCase()===n.toLowerCase()):null;l&&this.openModalForItemWithTransition(l,e,"skill",t.currentToolsContext)}openModalForItemWithTransition(e,t,n=null,l=null){this.openModalForItem(e,n,l)}openModalForItem(e,t=null,n=null){const l=this.s,a=e instanceof HTMLElement?e.classList.contains("skill-item"):"skill"===t,s=e instanceof HTMLElement?e.dataset:e,r=a&&l.modal&&"flex"===l.modal.style.display&&l.secModal&&n,o=r?l.secModal:l.modal,i=r?"sec-":"";if(r&&n&&(l.currentToolsContext=n,l.currentToolIndex=l.currentToolsContext.findIndex(e=>e.toLowerCase()===s.name.toLowerCase())),!r){l.currentGalleryIndex=0,this.galleryLoadId+=1;const t=document.querySelector(".modal-body-split"),n=document.querySelector(".modal-content");t&&(t.scrollTop=0),n&&(n.scrollTop=0);const a=l.isSkillsPage?l.skillsList:l.portfolioGrid,s=l.isSkillsPage?".skill-item":".portfolio-card";l.currentItemCard=e instanceof HTMLElement?e:null;const r=a?Array.from(a.querySelectorAll(s)).filter(e=>"none"!==e.style.display):[],o=l.isAchievementsPage&&l.achievementVideos&&l.achievementVideos.length>1,i=l.currentItemCard&&r.length>1;l.showModalNavArrows=o||i,l.prevBtn&&(l.prevBtn.style.visibility=l.showModalNavArrows?"visible":"hidden"),l.nextBtn&&(l.nextBtn.style.visibility=l.showModalNavArrows?"visible":"hidden");let c=document.getElementById("modal-gallery");if(c&&c.parentElement.classList.contains("gallery-container-wrapper")){const e=c.parentElement;e.parentNode.insertBefore(c,e),e.remove()}c&&(c.innerHTML="",c.scrollLeft=0)}if(a){o.classList.add("modal-skill");const t=document.getElementById(i+"project-header"),n=document.getElementById(i+"skill-header"),a=document.getElementById(i+"project-info"),c=document.getElementById(i+"skill-info"),d=o.querySelector(".modal-media-pane");if(t&&(t.style.display="none"),n&&(n.style.display="flex"),a&&(a.style.display="none"),c&&(c.style.display="block"),d&&(d.style.display="none"),!r){const e=o.querySelector(".modal-info-pane > div:last-child");e&&(e.style.display="none")}const m=document.getElementById(i+"modal-title-main");m&&(m.innerText=s.name.toUpperCase().trim());const u=document.getElementById(i+"bio-description");u&&(u.innerText=s.info||"No description available.");const h=document.getElementById(i+"modal-skill-icon");h&&(h.src=this.fixImagePath(s.icon||(e instanceof HTMLElement?e.querySelector("img").src:"")),h.alt=s.name);const g=document.getElementById(i+"modal-skill-type");g&&(g.innerText=s.badge||(e instanceof HTMLElement?e.querySelector(".type-badge").innerText:""));const p=document.getElementById(i+"modal-skill-level");p&&(p.innerText=s.level||(e instanceof HTMLElement?e.querySelector(".level").innerText:"-"));const f=document.getElementById(i+"modal-skill-last");f&&(f.innerText=s.lastUsed||(e instanceof HTMLElement?e.querySelector(".last-used").innerText:"-"));const y=document.getElementById(i+"modal-skill-cert-container"),v=document.getElementById(i+"modal-skill-cert-name");if(y&&v){("true"===s.certified||!0===s.certified)&&s.certName?(y.style.display="block",v.innerText=s.certName):(y.style.display="none",v.innerText="-")}if(r)l.secPrevBtn&&(l.secPrevBtn.style.display=l.currentToolsContext.length>1?"flex":"none"),l.secNextBtn&&(l.secNextBtn.style.display=l.currentToolsContext.length>1?"flex":"none");else{l.videoFrame&&(l.videoFrame.style.display="none");const e=document.getElementById("big-image-view");e&&e.remove()}}else{o.classList.remove("modal-skill");const e=document.getElementById("project-header"),t=document.getElementById("skill-header"),n=document.getElementById("project-info"),a=document.getElementById("skill-info"),r=o.querySelector(".modal-media-pane"),i=o.querySelector(".modal-info-pane > div:last-child");e&&(e.style.display="block"),t&&(t.style.display="none"),n&&(n.style.display="block"),a&&(a.style.display="none"),r&&(r.style.display="block"),i&&(i.style.display="block");const c=Array.isArray(s.gallery)?s.gallery.join(","):s.gallery||"",d=s.date,m=s.tools,u=s.info,h=Utils.extractYouTubeID(s.youtube||""),g=h&&s.youtube&&(s.youtube.includes("/shorts/")||s.youtube.toLowerCase().includes("shorts")),p=document.getElementById("modal-title");p&&(p.innerText=s.name.toUpperCase());const f=document.getElementById("modal-info-title");f&&(f.innerText=s.name.toUpperCase());const y=document.getElementById("modal-info-category");y&&(y.innerText=(s.badge||"").toUpperCase(),y.style.display=s.badge?"block":"none");const v=document.getElementById("modal-tools");if(v)if(v.innerHTML="",m){const e=[];let t=0;const n=()=>{v.querySelectorAll(".tool-icon-skeleton").forEach(e=>e.remove())},a=()=>{t+=1,t>=e.length&&n()};m.split(",").map(e=>e.trim()).forEach(t=>{const n=document.createElement("span");n.className="software-tag";const s=l.allData&&l.allData.skills?l.allData.skills.find(e=>e.name.toLowerCase()===t.toLowerCase())||l.allData.skills.find(e=>e.name.toLowerCase().includes(t.toLowerCase()))||l.allData.skills.find(e=>t.toLowerCase().includes(e.name.toLowerCase())):null;if(s&&s.icon){const t=document.createElement("span");t.className="tool-icon-wrap";const l=document.createElement("span");l.className="tool-icon-skeleton skeleton-element";const r=document.createElement("img");r.src=this.fixImagePath(s.icon),r.className="tool-icon",t.appendChild(l),t.appendChild(r),n.appendChild(t),e.push(r),r.onload=a,r.onerror=a}const r=document.createElement("span");if(r.innerText=t.toUpperCase(),n.appendChild(r),s&&s.certified){const e=document.createElement("span");e.className="grid-certified-badge",e.title=s.certName||"Certified",e.innerText="CERTIFIED",n.appendChild(e)}s&&(n.classList.add("clickable-tool"),n.addEventListener("click",e=>{e.stopPropagation();const t=m.split(",").map(e=>e.trim());this.openModalForItem(s,"skill",t)})),v.appendChild(n)}),0===e.length&&n(),e.forEach(e=>{e.complete&&a()})}else v.innerText="NONE";const w=document.getElementById("modal-description");w&&(w.innerText=u);const b=document.getElementById("modal-date");b&&(b.innerText=Utils.formatFullDate(d).toUpperCase());const k=document.getElementById("film-festival-awards"),S=document.getElementById("awards-list"),x="/games"===l.currentRoute;if(k&&S&&l.filmFestivalAwards&&!x){const e=l.filmFestivalAwards[s.name];e&&e.length>0?(k.style.display="block",S.innerHTML="",e.forEach(e=>{const t=(e.location||"").split("|").map(e=>e.trim()),n=t[0]||"",l=t[1]||"",a=document.createElement("div");a.className="award-item",a.innerHTML=`\n                            <div style="background: #000000; padding: 0; margin-bottom: 8px;">\n                                <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; margin-bottom: 2px;">\n                                    <strong style="color: #ffffff; font-size: 0.85rem;">${e.award}</strong>\n                                    <span style="color: #ffffff; font-size: 0.75rem; white-space: nowrap; opacity: 0.7;">${e.date}</span>\n                                </div>\n                                <div style="display: flex; flex-direction: column; gap: 2px;">\n                                    <span style="color: #ffffff; font-size: 0.75rem; opacity: 0.85;">${l}</span>\n                                    <span style="color: #ffffff; font-size: 0.65rem; opacity: 0.6;">${n}</span>\n                                </div>\n                            </div>\n                        `,S.appendChild(a)})):k.style.display="none"}else k&&(k.style.display="none");const E=h&&""!==h.trim()&&"YOUTUBE_ID_HERE"!==h,C=c?c.split(",").map(e=>e.trim()):[],I=C.length>0?C[0]:"",L=this.galleryLoadId,T=document.getElementById("modal-gallery"),M=document.getElementById("gallery-toggle"),A=C.length+(E?1:0),B=A>1;let P=T&&T.parentElement&&T.parentElement.classList.contains("gallery-container-wrapper")?T.parentElement:null,D=null;if(l.galleryCollapsed=!B,l.canToggleGallery=B,l.galleryHasRendered=!1,l.galleryEl=T,l.galleryWrapper=P,l.galleryToggleEl=M,l.galleryTargetModal=o,M&&!M.hasAttribute("data-toggle-bound")&&(M.setAttribute("data-toggle-bound","true"),M.addEventListener("click",()=>{this.s.canToggleGallery&&(this.s.galleryCollapsed=!this.s.galleryCollapsed,this.applyGalleryState())})),this.applyGalleryState(),T&&(B||(T.innerHTML="")),E)this.showVideo(h,g),l.videoFrame&&(l.videoFrame.style.display="block");else{l.videoFrame&&(l.videoFrame.style.display="none",l.videoFrame.src="");const e=document.getElementById("big-image-view");e&&e.remove();const t=document.querySelector(".media-skeleton");if(t&&t.remove(),C.length>0&&l.mediaContainer){const e=document.createElement("div");e.className="media-skeleton",l.mediaContainer.appendChild(e)}}const $=E?`https://img.youtube.com/vi/${h}/mqdefault.jpg`:I?this.fixImagePath(I):"";if($&&this.preloadImage($,3e3).then(e=>{if(L!==this.galleryLoadId)return;const t=document.querySelector(".media-skeleton");if(t&&t.remove(),!E&&I&&(this.showImage(I),T&&B)){const e=this.fixImagePath(I);if(!T.querySelector(`img[data-gallery-src="${e}"]`)){const t=document.createElement("img");t.src=e,t.alt="Screenshot 1",t.setAttribute("data-gallery-src",e),t.classList.add("selected"),t.addEventListener("click",()=>{l.currentGalleryIndex=0;Array.from(T.children).filter(e=>"IMG"===e.tagName||e.classList.contains("video-thumb-btn")).forEach((e,t)=>{0===t?e.classList.add("selected"):e.classList.remove("selected")}),this.centerItemInGallery(T,t),this.showImage(I),D&&this.updateGalleryButtons(T,D.gPrev,D.gNext)});const n=T.querySelector(".gallery-skeleton");n?n.replaceWith(t):T.insertBefore(t,T.firstChild)}}}),T&&B){D=this.ensureGalleryControls(T),D.wrapper&&(P=D.wrapper,l.galleryWrapper=P),this.applyGalleryState(),this.buildGallerySkeletons(T,A),this.updateGalleryButtons(T,D.gPrev,D.gNext);const e=E?`https://img.youtube.com/vi/${h}/mqdefault.jpg`:"";if(E){const t=document.createElement("button");t.className="video-thumb-btn selected",t.innerHTML=`\n                        <img src="${e}" alt="Video Thumbnail">\n                        <div class="video-overlay">\n                            <span class="video-play-icon">â–¶</span>\n                            <span class="video-label">VIDEO</span>\n                        </div>\n                    `,t.addEventListener("click",()=>{l.currentGalleryIndex=0;Array.from(T.children).filter(e=>"IMG"===e.tagName||e.classList.contains("video-thumb-btn")).forEach((e,t)=>{0===t?e.classList.add("selected"):e.classList.remove("selected")}),this.centerItemInGallery(T,t),this.showVideo(h,g),this.updateGalleryButtons(T,D.gPrev,D.gNext)});const n=T.querySelector(".gallery-skeleton");n?n.replaceWith(t):T.insertBefore(t,T.firstChild)}const t=[];C.forEach(e=>{const n=this.fixImagePath(e);t.push(this.preloadImage(n,3e3))});const n=Date.now();Promise.all(t).then(e=>{const t=e.every(e=>e.cached),l=Date.now()-n,a=t?0:Math.max(0,120-l);return Promise.all([e,this.delay(a)])}).then(([e])=>{if(L!==this.galleryLoadId)return;if(!T)return;T.querySelectorAll(".gallery-skeleton").forEach(e=>e.remove());const t=D.gPrev||document.getElementById("gallery-prev"),n=D.gNext||document.getElementById("gallery-next"),a=E?1:0;if(C.forEach((e,s)=>{const r=document.createElement("img"),o=this.fixImagePath(e);if(T.querySelector(`img[data-gallery-src="${o}"]`))return;r.src=o,r.alt=`Screenshot ${s+1}`,r.setAttribute("data-gallery-src",o);const i=s+a;E||0!==s||r.classList.add("selected"),r.addEventListener("click",()=>{var a;l.currentGalleryIndex=i,a=i,Array.from(T.children).filter(e=>"IMG"===e.tagName||e.classList.contains("video-thumb-btn")).forEach((e,t)=>{t===a?e.classList.add("selected"):e.classList.remove("selected")}),this.centerItemInGallery(T,r),this.showImage(e),this.updateGalleryButtons(T,t,n)}),T.appendChild(r)}),this.initGalleryDrag(T),T.children.length>1){const e=this.ensureGalleryControls(T);e.gPrev&&(e.gPrev.onclick=t=>{t.stopPropagation(),this.navigateGallery(T,-1,e.gPrev,e.gNext)}),e.gNext&&(e.gNext.onclick=t=>{t.stopPropagation(),this.navigateGallery(T,1,e.gPrev,e.gNext)}),this.updateGalleryButtons(T,e.gPrev,e.gNext)}})}}if(o){o.style.display="flex",o.style.zIndex=99999;try{document.body.style.overflow="hidden"}catch(e){}const e=o.querySelector(".modal-content");e&&(e.style.display="flex"),this.adjustModalPadding(o)}}navigateGallery(e,t,n,l){const a=this.s,s=Array.from(e.children).filter(e=>!e.classList.contains("gallery-nav-btn"));if(0===s.length)return;let r=a.currentGalleryIndex+t;r>=s.length?r=0:r<0&&(r=s.length-1),a.currentGalleryIndex=r;const o=s[a.currentGalleryIndex];o.click(),this.centerItemInGallery(e,o),this.updateGalleryButtons(e,n,l)}updateGalleryButtons(e,t,n){if(!t||!n)return;const l=Array.from(e.children).filter(e=>!e.classList.contains("gallery-nav-btn")).length>1;t.style.visibility=l?"visible":"hidden",n.style.visibility=l?"visible":"hidden"}adjustModalPadding(e){const t=this.s;if(!e)return;const n=e.querySelector(".modal-content");if(e===t.secModal){const e=t.secPrevBtn,l=t.secNextBtn;try{const t=e?getComputedStyle(e).visibility:"hidden",a=l?getComputedStyle(l).visibility:"hidden";n&&("hidden"===t&&"hidden"===a?n.classList.add("no-side-padding"):n.classList.remove("no-side-padding"))}catch(e){}}else n&&(t.showModalNavArrows?n.classList.remove("no-side-padding"):n.classList.add("no-side-padding"))}centerItemInGallery(e,t){const n=e.getBoundingClientRect(),l=t.getBoundingClientRect(),a=l.left-n.left+e.scrollLeft+l.width/2-e.clientWidth/2;e.scrollTo({left:Math.max(0,Math.min(a,e.scrollWidth-e.clientWidth)),behavior:"smooth"})}initGalleryDrag(e){if(e.hasAttribute("data-drag-init"))return;e.setAttribute("data-drag-init","true");let t,n,l=!1,a=!1;const s=()=>{e.style.cursor=e.scrollWidth>e.clientWidth?"grab":"default"},r=t=>{if(l&&(l=!1,s(),e.style.userSelect="",e.querySelectorAll("img, .video-thumb-btn, .gallery-skeleton").forEach(e=>e.style.pointerEvents="auto"),a)){const t=Array.from(e.querySelectorAll("img, .video-thumb-btn"));if(t.length>0){const n=e.getBoundingClientRect(),l=n.left+n.width/2;let a=null,s=1/0;t.forEach(e=>{const t=e.getBoundingClientRect(),n=t.left+t.width/2,r=Math.abs(l-n);r<s&&(s=r,a=e)}),a&&(a.classList.contains("selected")?this.centerItemInGallery(e,a):a.click())}}};e.addEventListener("mousedown",s=>{e.scrollWidth<=e.clientWidth||(l=!0,a=!1,t=(s.clientX||s.pageX)-e.getBoundingClientRect().left,n=e.scrollLeft,e.style.cursor="grabbing",e.style.userSelect="none")}),window.addEventListener("mousemove",s=>{if(!l)return;const r=2*((s.clientX||s.pageX)-e.getBoundingClientRect().left-t);Math.abs(r)>5&&(a||(a=!0,e.querySelectorAll("img, .video-thumb-btn").forEach(e=>e.style.pointerEvents="none")),e.scrollLeft=n-r)}),window.addEventListener("mouseup",r),e.addEventListener("mouseleave",()=>{l&&r()}),e.addEventListener("dragstart",e=>e.preventDefault()),s(),setTimeout(s,100)}}class ControlsManager{constructor(e){this.s=e}initControlSkeletons(){const e=this.s;e.searchContainer&&(e.searchContainer.innerHTML='<div class="skeleton-element" style="height: 34px; border-radius: 6px;"></div>'),e.sortSelectContainer&&(e.sortSelectContainer.innerHTML='<div class="skeleton-element" style="height: 34px; border-radius: 6px;"></div>'),e.orderSelectContainer&&(e.orderSelectContainer.innerHTML='<div class="skeleton-element" style="height: 34px; border-radius: 6px;"></div>'),e.typeSelectContainer&&(e.typeSelectContainer.innerHTML='<div class="skeleton-element" style="height: 34px; border-radius: 6px; width: 140px;"></div>'),e.toolSelectContainer&&(e.toolSelectContainer.innerHTML='<div class="skeleton-element" style="height: 34px; border-radius: 6px; width: 140px;"></div>')}renderStaticControls(){const e=this.s,t=e.isSkillsPage?"Search skills...":"Search projects...";this.renderSearchBox(e.searchContainer,e.searchQuery,t,t=>{e.searchQuery=t,e.isSkillsPage?e.filterSkills():e.filterCards()});const n=e.isSkillsPage?[{id:"name",label:"Name"},{id:"proficiency",label:"Proficiency"},{id:"lastUsed",label:"Last Used"}]:[{id:"date",label:"Date"},{id:"name",label:"Name"}];this.renderSingleSelect(e.sortSelectContainer,n,e.selectedSort,t=>{e.selectedSort=t,e.isSkillsPage?e.sortSkills():e.sortCards()});this.renderSingleSelect(e.orderSelectContainer,[{id:"desc",label:"Descending"},{id:"asc",label:"Ascending"}],e.selectedOrder,t=>{e.selectedOrder=t,e.isSkillsPage?e.sortSkills():e.sortCards()})}updateTypeFilter(e){const t=this.s;if(!t.typeSelectContainer)return;const n=Array.from(e.entries()).sort((e,t)=>e[1].localeCompare(t[1])).map(([e,t])=>({id:e,label:t}));n.length>1&&!n.find(e=>"all"===e.id)&&n.unshift({id:"all",label:"All Categories"}),t.selectedCategories.includes("all")&&!n.find(e=>"all"===e.id)&&n.length>0&&(t.selectedCategories=[n[0].id]),this.renderMultiSelect(t.typeSelectContainer,n,t.selectedCategories,e=>{t.selectedCategories=e,t.isSkillsPage?t.filterSkills():t.filterCards()})}updateToolFilter(e){const t=this.s;if(!t.toolSelectContainer)return;const n=Array.from(e.entries()).sort((e,t)=>e[1].localeCompare(t[1])).map(([e,t])=>({id:e,label:t}));n.length>1&&!n.find(e=>"all"===e.id)&&n.unshift({id:"all",label:"All Tools"}),t.selectedTools.includes("all")&&!n.find(e=>"all"===e.id)&&n.length>0&&(t.selectedTools=[n[0].id]),this.renderMultiSelect(t.toolSelectContainer,n,t.selectedTools,e=>{t.selectedTools=e,t.filterCards()})}renderMultiSelect(e,t,n,l){const a=e.classList.contains("open");e.innerHTML="",e.className="multi-select-container"+(a?" open":"");const s=t.some(e=>"all"===e.id),r=t.filter(e=>"all"!==e.id).map(e=>e.id),o=n.includes("all"),i=document.createElement("div");if(i.className="multi-select-trigger",o)i.textContent=t.find(e=>"all"===e.id)?.label||"All";else if(0===n.length)i.textContent="None Selected";else if(1===n.length){const e=t.find(e=>e.id===n[0]);i.textContent=e?e.label:n[0]}else i.textContent=`${n.length} Selected`;const c=document.createElement("div");c.className="multi-select-dropdown",t.forEach(a=>{const i=document.createElement("div");i.className="multi-select-item";const d="all"===a.id?o:o||n.includes(a.id);d&&i.classList.add("selected");const m=document.createElement("input");m.type="checkbox",m.checked=d;const u=document.createElement("span");u.textContent=a.label,i.appendChild(m),i.appendChild(u),i.addEventListener("click",i=>{i.stopPropagation(),"all"===a.id?o?n.length=0:(n.length=0,n.push("all")):(o?(n.length=0,r.forEach(e=>{e!==a.id&&n.push(e)})):n.includes(a.id)?n.splice(n.indexOf(a.id),1):n.push(a.id),s&&r.every(e=>n.includes(e))&&(n.length=0,n.push("all"))),this.renderMultiSelect(e,t,n,l),l(n)}),c.appendChild(i)}),i.addEventListener("click",t=>{t.stopPropagation(),document.querySelectorAll(".custom-select-container, .multi-select-container").forEach(t=>{t!==e&&t.classList.remove("open")}),e.classList.toggle("open")}),e.appendChild(i),e.appendChild(c)}renderSingleSelect(e,t,n,l){if(!e)return;const a=e.classList.contains("open");e.innerHTML="",e.className="custom-select-container"+(a?" open":"");const s=document.createElement("div");s.className="custom-select-trigger";const r=t.find(e=>e.id===n);s.textContent=r?r.label:n;const o=document.createElement("div");o.className="custom-select-dropdown",t.forEach(a=>{const s=document.createElement("div");s.className="custom-select-item",a.id===n&&s.classList.add("selected"),s.textContent=a.label,s.addEventListener("click",n=>{n.stopPropagation(),e.classList.remove("open"),l(a.id),this.renderSingleSelect(e,t,a.id,l)}),o.appendChild(s)}),s.addEventListener("click",t=>{t.stopPropagation();const n=e.classList.contains("open");document.querySelectorAll(".custom-select-container, .multi-select-container").forEach(e=>e.classList.remove("open")),n||e.classList.add("open")}),e.appendChild(s),e.appendChild(o)}renderSearchBox(e,t,n,l){if(!e)return;const a=this.s;e.innerHTML="";const s=document.createElement("div");s.className="search-container";const r=document.createElement("input");let o;r.type="text",r.id="portfolio-search",r.className="custom-input",r.placeholder=n||"Search...",r.value=t,r.autocomplete="off",r.addEventListener("input",e=>{clearTimeout(o),o=setTimeout(()=>{l(e.target.value)},150)}),s.appendChild(r),e.appendChild(s),a.searchInput=r}}class Renderer{constructor(e){this.s=e}fixImagePath(e){if(!e)return e;if(e.startsWith("http")||e.startsWith("data:")){if(e.includes("drive.google.com")&&!e.includes("lh3.google.com")){const t=e.match(/\/d\/([a-zA-Z0-9_-]+)/);if(t)return`https://lh3.google.com/d/${t[1]}=w1200`}return e}return e.startsWith("../")?e:"../"+e}showSkeletons(e,t){if(!e)return;const n="portfolio-grid"===e.id,l="skills-list"===e.id;e.style.visibility="visible",e.style.display=n?"grid":"block",e.innerHTML=l?'<div class="grid-structure grid-header"><span>Skill</span><span>Proficiency</span><span>Last Used</span></div>':"";let a="";l?a='\n                <div class="grid-structure skill-item skeleton-item">\n                    <div class="skeleton-element" style="width: 32px; height: 32px; border-radius: 4px;"></div>\n                    <div class="skill-meta">\n                        <div class="skeleton-element" style="width: 120px; height: 14px; margin-bottom: 6px; border-radius: 4px;"></div>\n                        <div class="skeleton-element" style="width: 70px; height: 10px; border-radius: 4px;"></div>\n                    </div>\n                    <div class="skeleton-element" style="width: 90px; height: 14px; border-radius: 4px;"></div>\n                    <div class="skeleton-element" style="width: 70px; height: 14px; border-radius: 4px;"></div>\n                </div>':n&&(a='\n                <div class="portfolio-card skeleton-item">\n                    <div class="card-thumb"><div class="skeleton-element" style="width: 100%; height: 100%;"></div></div>\n                    <div class="card-content">\n                        <div class="skeleton-element" style="width: 80%; height: 18px; margin-bottom: 10px; border-radius: 4px;"></div>\n                        <div class="skeleton-element" style="width: 40%; height: 14px; border-radius: 4px;"></div>\n                        <div class="skeleton-element" style="width: 55%; height: 12px; margin-top: 10px; border-radius: 4px;"></div>\n                    </div>\n                </div>');for(let n=0;n<t;n++)e.insertAdjacentHTML("beforeend",a)}renderProjects(e){const t=this.s;if(!t.portfolioGrid||!e)return;t.portfolioGrid.innerHTML="",e.forEach(e=>{try{const n=document.createElement("div");n.className="portfolio-card",n.setAttribute("data-name",e.name||""),n.setAttribute("data-date",e.date||""),n.setAttribute("data-info",e.info||""),n.setAttribute("data-tools",e.tools||""),n.setAttribute("data-youtube",e.youtube||""),n.setAttribute("data-type",e.badge||""),n.setAttribute("data-badge",e.badge||""),n.setAttribute("data-gallery",e.gallery?e.gallery.join(", "):"");let l=e.resolvedThumb||e.gallery?.[0]||"";const a=Utils.extractYouTubeID(e.youtube||""),s=a&&""!==a.trim()&&"YOUTUBE_ID_HERE"!==a;l=s?e.resolvedThumb||`https://img.youtube.com/vi/${a}/maxresdefault.jpg`:e.resolvedThumb||this.fixImagePath(l);const r=e.date?Utils.formatFullDate(e.date).toUpperCase():"",o=e.badge?`<span class="type-badge" style="margin-top: 10px; display: block;">${e.badge}</span>`:"",i="/videos"===t.currentRoute&&t.filmFestivalAwards?t.filmFestivalAwards[e.name]:null;let c="",d="";if(i&&i.length>0){const e=i.map(e=>`${e.award} - ${e.location}`).join("\n");d=i.map(e=>`${e.award} ${e.location}`).join(" "),c=`<span class="awards-badge" title="${e}">WON AWARDS</span>`}else c="";n.setAttribute("data-awards",d),n.innerHTML=`\n                    <div class="card-thumb">\n                        <img src="${l}" alt="${e.name}" loading="lazy">\n                    </div>\n                    <div class="card-content">\n                        <div class="card-info">\n                            <h4>${e.name||""}</h4>\n                            <p>${r}</p>\n                            ${o}\n                        </div>\n                        ${c?`<div class="card-awards">${c}</div>`:""}\n                    </div>`;const m=n.querySelector("img");m&&s&&(m.onload=function(){120===this.naturalWidth&&90===this.naturalHeight&&(this.style.opacity="0.3",this.style.filter="blur(2px)")},m.onerror=function(){this.style.opacity="0.3"}),n.addEventListener("click",()=>t.openModalForItem(n)),t.portfolioGrid.appendChild(n)}catch(e){}});const n=new Map,l=new Map;e.forEach(e=>{e.badge&&n.set(e.badge,e.badge),e.tools&&e.tools.split(",").forEach(e=>{const t=e.trim();t&&l.set(t,t)})}),t.updateTypeFilter(n),t.updateToolFilter(l),t.sortCards()}renderSkills(e){const t=this.s;if(!t.skillsList||!e)return;const n=!!t.isAchievementsPage;t.skillsList.innerHTML='<div class="grid-structure grid-header"><span>Skill</span><span>Proficiency</span><span>Last Used</span></div>';const l=new Map;e.forEach(e=>{if(n&&!e.certified)return;e.badge&&l.set(e.badge,e.badge);const a=document.createElement("div");a.className="grid-structure skill-item",a.setAttribute("data-type",e.badge||""),a.setAttribute("data-name",e.name),a.setAttribute("data-info",e.info||""),a.setAttribute("data-certified",e.certified?"true":"false"),a.setAttribute("data-cert-name",e.certName||""),a.setAttribute("data-badge",e.badge||"");const s=e.certified?`<span class="grid-certified-badge" title="${e.certName?e.certName:e.name}">CERTIFIED</span>`:"",r=e.resolvedIcon||this.fixImagePath(e.icon);a.innerHTML=`\n                <span class="skill-icon-wrap">\n                    <span class="skill-icon-skeleton skeleton-element"></span>\n                    <img src="${r}" class="skill-icon" loading="lazy" onerror="this.style.opacity='0.5';">\n                </span>\n                <span class="skill-meta">\n                    <span class="skill-name">${e.name}${s}</span>\n                    <span class="type-badge">${e.badge}</span>\n                </span>\n                <span class="level">${e.level}</span>\n                <span class="last-used">${e.lastUsed}</span>`;const o=a.querySelector(".skill-icon"),i=a.querySelector(".skill-icon-skeleton");if(o&&i){const e=()=>{i.parentElement&&i.remove()};o.onload=e,o.onerror=e,o.complete&&e()}a.addEventListener("click",()=>t.openModalForItem(a)),t.skillsList.appendChild(a)}),t.updateTypeFilter(l),t.sortSkills()}}class FilterManager{constructor(e){this.s=e}normalizeText(e){return e?String(e).toLowerCase().replace(/[^a-z0-9\s]/g," ").replace(/\s+/g," ").trim():""}levenshtein(e,t){if(e===t)return 0;const n=e.length,l=t.length;if(0===n)return l;if(0===l)return n;const a=Array.from({length:n+1},()=>new Array(l+1).fill(0));for(let e=0;e<=n;e++)a[e][0]=e;for(let e=0;e<=l;e++)a[0][e]=e;for(let s=1;s<=n;s++)for(let n=1;n<=l;n++){const l=e[s-1]===t[n-1]?0:1;a[s][n]=Math.min(a[s-1][n]+1,a[s][n-1]+1,a[s-1][n-1]+l)}return a[n][l]}expandQueryTerms(e){if(!e)return[""];const t=this.normalizeText(e),n=new Set;return t&&n.add(t),t.split(/\s+/).forEach(e=>{e&&n.add(e)}),Array.from(n)}fuzzyTermMatch(e,t){if(!t)return!0;const n=this.normalizeText(t);if(!n)return!0;if(e.join(" ").includes(n))return!0;if(n.length<=2){for(const t of e)if(t===n)return!0;const t=new Set,l=e.length;for(let n=1;n<=Math.min(3,l);n++)for(let a=0;a+n<=l;a++){const l=e.slice(a,a+n).map(e=>e.charAt(0)).join("");l&&t.add(l)}for(const e of t)if(e===n)return!0;return!1}if(n.length<=3){const t=new Set,l=e.length;for(let n=1;n<=Math.min(4,l);n++)for(let a=0;a+n<=l;a++){const l=e.slice(a,a+n).map(e=>e.charAt(0)).join("");l&&t.add(l)}for(const e of t){if(e===n)return!0;if(this.levenshtein(e,n)<=1)return!0}}const l=n.split(/\s+/);for(const t of l){let n=!1;for(const l of e)if(l){if(l.includes(t)){n=!0;break}if(t.length>=3&&Math.abs(l.length-t.length)<=1&&this.levenshtein(l,t)<=1){n=!0;break}}if(!n)return!1}return!0}filterCards(){const e=this.s;if(!e.portfolioGrid)return;const t=this.normalizeText(e.searchQuery).split(/\s+/).filter(e=>e);let n=0;e.portfolioGrid.querySelectorAll(".portfolio-card").forEach(l=>{const a=l.getAttribute("data-type")||"",s=(l.getAttribute("data-tools")||"").toLowerCase(),r=s.split(",").map(e=>e.trim()),o=(l.getAttribute("data-awards")||"").toLowerCase(),i=e.selectedCategories.includes("all")||e.selectedCategories.includes(a),c=e.selectedTools.includes("all")||r.some(t=>e.selectedTools.map(e=>e.toLowerCase()).includes(t)),d=(l.innerText||"")+" "+s+" "+(l.getAttribute("data-info")||"")+" "+o,m=this.normalizeText(d).split(/\s+/);let u=!0;if(1===t.length)u=this.fuzzyTermMatch(m,t[0]);else if(t.length>1){const e=t.filter(e=>e.length>=3);u=(e.length>0?e:t).every(e=>this.fuzzyTermMatch(m,e))}i&&c&&u?(l.style.display="block",n++):l.style.display="none"}),e.noResults&&(e.noResults.style.display=0===n?"block":"none")}filterSkills(){const e=this.s;if(!e.skillsList)return;const t=this.normalizeText(e.searchQuery).split(/\s+/).filter(e=>e);let n=0;e.skillsList.querySelectorAll(".skill-item").forEach(l=>{const a=l.getAttribute("data-info")||"",s=(l.innerText||"")+" "+a,r=this.normalizeText(s).split(/\s+/).filter(e=>e);let o=!0;if(1===t.length)o=this.fuzzyTermMatch(r,t[0]);else if(t.length>1){const e=t.filter(e=>e.length>=3);o=(e.length>0?e:t).every(e=>this.fuzzyTermMatch(r,e))}const i=e.selectedCategories.includes("all")||e.selectedCategories.includes(l.dataset.type);o&&i?(l.style.display="",n++):l.style.display="none"}),e.noResults&&(e.noResults.style.display=0===n?"block":"none")}sortSkills(){const e=this.s;if(!e.skillsList)return;const t=e.selectedSort,n=e.selectedOrder,l=Array.from(e.skillsList.querySelectorAll(".skill-item"));l.sort((e,l)=>{let a,s;const r=e.dataset.name.toLowerCase().trim(),o=l.dataset.name.toLowerCase().trim();return"name"===t?(a=r,s=o):"proficiency"===t?(a=Utils.getProficiencyValue(e.querySelector(".level").innerText),s=Utils.getProficiencyValue(l.querySelector(".level").innerText)):(a=new Date(e.querySelector(".last-used").innerText).getTime()||0,s=new Date(l.querySelector(".last-used").innerText).getTime()||0),a===s?r.localeCompare(o):"desc"===n?a>s?-1:1:a<s?-1:1}),l.forEach(t=>e.skillsList.appendChild(t))}sortCards(){const e=this.s;if(!e.portfolioGrid)return;const t=e.selectedSort,n=e.selectedOrder,l=Array.from(e.portfolioGrid.querySelectorAll(".portfolio-card"));l.sort((e,l)=>{let a,s;return"name"===t?(a=e.getAttribute("data-name").toLowerCase(),s=l.getAttribute("data-name").toLowerCase()):(a=new Date(e.getAttribute("data-date").replace(/-/g,"/")).getTime(),s=new Date(l.getAttribute("data-date").replace(/-/g,"/")).getTime()),"asc"===n?a-s:s-a}),l.forEach(t=>e.portfolioGrid.appendChild(t))}}let globalSearchData={videos:[],games:[],skills:[],achievements:[]};function initializeGlobalSearch(){const e=document.getElementById("global-search-btn"),t=document.getElementById("global-search-modal"),n=document.getElementById("global-search-input");if(!e||!t||!n)return;const l=t.querySelector(".search-close-btn");document.getElementById("search-results");if(e.dataset.initialized)return;e.dataset.initialized="true",e.addEventListener("click",()=>{openGlobalSearch()}),l.addEventListener("click",()=>{closeGlobalSearch()});let a,s=null;t.addEventListener("mousedown",e=>{s=e.target}),t.addEventListener("click",e=>{e.target===t&&s===t&&closeGlobalSearch(),s=null}),document.addEventListener("keydown",e=>{"Escape"===e.key&&t.classList.contains("active")&&closeGlobalSearch()}),n.addEventListener("input",e=>{clearTimeout(a),a=setTimeout(()=>{performSearch(e.target.value)},200)})}function openGlobalSearch(){const e=document.getElementById("global-search-modal"),t=document.getElementById("global-search-input"),n=document.getElementById("search-results");e.classList.add("active"),t.value="",n&&(n.innerHTML='<div class="search-no-results"><div class="search-no-results-text">Start typing to search</div><div class="search-no-results-hint">Search across all projects, skills, and achievements</div></div>'),t.focus(),loadAllSearchData()}function closeGlobalSearch(){const e=document.getElementById("global-search-modal"),t=document.getElementById("global-search-input"),n=document.getElementById("search-results");e.classList.remove("active"),t&&(t.value=""),n&&(n.innerHTML="")}async function loadAllSearchData(){if(window.dataService){if(0===globalSearchData.videos.length){const e=await window.dataService.loadSheet("videos");globalSearchData.videos=e.data||[],window.state&&e.data&&(window.state.filmFestivalAwards=window.dataService.buildFilmFestivalAwards(e.data))}if(0===globalSearchData.games.length){const e=await window.dataService.loadSheet("games");globalSearchData.games=e.data||[]}if(0===globalSearchData.skills.length){const e=await window.dataService.loadSheet("skills");globalSearchData.skills=e.data||[]}if(0===globalSearchData.achievements.length){const e=await window.dataService.loadSheet("achievements");globalSearchData.achievements=e.data||[]}}}function performSearch(e){const t=document.getElementById("search-results");if(!e||0===e.trim().length)return void(t.innerHTML='<div class="search-no-results"><div class="search-no-results-text">Start typing to search</div><div class="search-no-results-hint">Search across all projects, skills, and achievements</div></div>');t.innerHTML='<div class="search-no-results"><div class="search-no-results-text">Searching...</div></div>';const n=[],l=e.toLowerCase();globalSearchData.videos.forEach(e=>{let t=getMatchScore(e,l,["name","info","badge"]);if(window.state&&window.state.filmFestivalAwards){const n=window.state.filmFestivalAwards[e.name];n&&n.length>0&&n.forEach(e=>{const n=(e.award||"").toLowerCase(),a=(e.location||"").toLowerCase();if(n===l)t+=200;else if(n.includes(l)||l.includes(n))t+=150;else{l.split(" ").forEach(e=>{e.length>2&&n.includes(e)&&(t+=80)})}a.includes(l)&&(t+=30)})}t>0&&n.push({type:"video",data:e,score:t,route:"/videos"})}),globalSearchData.games.forEach(e=>{const t=getMatchScore(e,l,["name","info","badge"]);t>0&&n.push({type:"game",data:e,score:t,route:"/games"})}),globalSearchData.skills.forEach(e=>{let t=getMatchScore(e,l,["name","badge"]);if(e.certName){const n=e.certName.toLowerCase();if(n===l)t+=200;else if(n.includes(l)||l.includes(n))t+=150;else{l.split(" ").forEach(e=>{e.length>2&&n.includes(e)&&(t+=80)})}}e.certified&&(l.includes("certified")||l.includes("certification"))&&(t+=30),t>0&&n.push({type:"skill",data:e,score:t,route:"/technical"})});const a=new Set(globalSearchData.videos.map(e=>e.name));globalSearchData.achievements.forEach(e=>{if(a.has(e.name))return;let t=getMatchScore(e,l,["name","info","badge","certName"]);(l.includes("film festival")||l.includes("festival")||l.includes("award")||l.includes("won"))&&(t+=25),t>0&&n.push({type:"achievement",data:e,score:t,route:"/achievements"})}),n.sort((e,t)=>t.score-e.score),renderSearchResults(n,e)}function getMatchScore(e,t,n){let l=0;return n.forEach(n=>{const a=(e[n]||"").toLowerCase();"name"===n&&(a===t?l+=100:a.includes(t)&&(l+=50)),a.includes(t)&&(l+=10,a.startsWith(t)&&(l+=20));t.split(" ").forEach(e=>{e.length>2&&a.includes(e)&&(l+=5)})}),l}function renderSearchResults(e,t){const n=document.getElementById("search-results");if(0===e.length)return void(n.innerHTML='<div class="search-no-results"><div class="search-no-results-text">No results found</div><div class="search-no-results-hint">Try different keywords</div></div>');let l=`<div style="padding: 10px 0 15px; color: #8b949e; font-size: 0.9rem;">\n        Showing results for "<span style="color: #58a6ff;">${escapeHtml(t)}</span>" (${e.length} ${1===e.length?"result":"results"})\n    </div>`;l+=e.map(e=>{const n=e.data.name||"Untitled",l=e.data.info||e.data.badge||"",a=highlightMatch(n,t),s=highlightMatch(l,t),r=[],o=`type-${e.type}`;let i=e.type.charAt(0).toUpperCase()+e.type.slice(1);if("achievement"===e.type&&(i="Won Awards"),r.push(`<span class="search-result-type ${o}">${i}</span>`),"video"===e.type&&window.dataService){const t=((window.state||{}).filmFestivalAwards||{})[e.data.name];if(t&&t.length>0){const e=t.map(e=>`${e.award} - ${e.location}`).join("\n");r.push(`<span class="search-result-type type-achievement" title="${e}" style="cursor: help;">Won Awards</span>`)}}if("skill"===e.type&&e.data.certified){const t=e.data.certName||e.data.name;r.push(`<span class="search-result-type type-certified" title="${t}" style="cursor: help;">Certified</span>`)}const c=r.join(" ");return`\n            <div class="search-result-item" onclick="navigateToSearchResult('${e.route}', '${escapeHtml(n)}', '${e.type}')">\n                <div class="search-result-header">\n                    ${c}\n                </div>\n                <div class="search-result-title">${a}</div>\n                ${s?`<div class="search-result-info">${s}</div>`:""}\n            </div>\n        `}).join(""),n.innerHTML=l}function highlightMatch(e,t){if(!e)return"";const n=new RegExp(`(${escapeRegex(t)})`,"gi");return e.replace(n,'<span class="search-result-match">$1</span>')}function escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function escapeHtml(e){return e.replace(/'/g,"&#39;").replace(/"/g,"&quot;")}function navigateToSearchResult(e,t,n){closeGlobalSearch(),window.location.pathname===e||window.location.pathname.endsWith(e)?waitForDataToLoad().then(()=>{openModalForSearchResult(t,n)}):(navigateTo(e),waitForDataToLoad().then(()=>{setTimeout(()=>{openModalForSearchResult(t,n)},300)}))}function waitForDataToLoad(){return new Promise(e=>{const t=setInterval(()=>{const n=document.querySelectorAll(".portfolio-card[data-name]").length>0,l=document.querySelectorAll(".skill-item[data-name]").length>0,a=!document.querySelector(".skeleton-card, .skeleton-item"),s=document.getElementById("portfolio-search");(n||l||a)&&s&&(clearInterval(t),e())},50);setTimeout(()=>{clearInterval(t),e()},5e3)})}function openModalForSearchResult(e,t){const n=document.getElementById("portfolio-search");n&&window.state&&(n.value=e,window.state.searchQuery=e,window.state.isSkillsPage?window.state.filterSkills():window.state.filterCards(),setTimeout(()=>{const t=document.querySelector(`.portfolio-card[data-name="${e}"]`),n=document.querySelector(`.skill-item[data-name="${e}"]`),l=t||n;if(l&&"none"!==l.style.display)l.click();else{const t=Array.from(document.querySelectorAll(".portfolio-card, .skill-item"));for(const n of t){if("none"===n.style.display)continue;const t=n.querySelector(".card-title, .skill-name, h3, h4")?.textContent.trim();if(t===e){n.click();break}}}},100))}document.addEventListener("DOMContentLoaded",()=>{const e={"/":{fragment:"html/pages/bio.html",title:"BIO"},"/bio":{fragment:"html/pages/bio.html",title:"BIO"},"/achievements":{fragment:"html/pages/achievements.html",title:"ACHIEVEMENTS"},"/technical":{fragment:"html/pages/technical.html",title:"TECHNICAL"},"/videos":{fragment:"html/pages/videos.html",title:"VIDEOS"},"/games":{fragment:"html/pages/games.html",title:"GAMES"}},t={modal:null,closeBtn:null,videoFrame:null,mediaContainer:null,prevBtn:null,nextBtn:null,secModal:null,secCloseBtn:null,secPrevBtn:null,secNextBtn:null,skillsList:null,achievementsList:null,portfolioGrid:null,noResults:null,toolSelectContainer:null,typeSelectContainer:null,sortSelectContainer:null,orderSelectContainer:null,searchContainer:null,searchInput:null,selectedCategories:["all"],selectedTools:["all"],selectedSort:null,selectedOrder:"desc",searchQuery:"",currentItemCard:null,currentGalleryIndex:0,currentToolsContext:[],currentToolIndex:-1,achievementVideos:[],currentAchievementVideoIndex:-1,showModalNavArrows:!1,allData:null,dataPromise:null,filmFestivalAwards:{},openModalForItem:null,filterCards:null,filterSkills:null,sortCards:null,sortSkills:null,updateTypeFilter:null,updateToolFilter:null,runFiltering:null,modalManager:null,filterManager:null,controlsManager:null,renderer:null,currentRoute:"/",isSkillsPage:!1,isAchievementsPage:!1,isPortfolioPage:!1,routeToken:0,didPrimeSkeletons:!1,primedSkeletonCount:0,primedSkeletonTarget:null,skeletonKey:null},n=new DataService("12V7XnylQtfLmT1ux5Va-DPhKc201m3fht9JstupnHdk");window.dataService=n,window.state=t;const l=Object.keys(e).sort((e,t)=>t.length-e.length);(()=>{const e=sessionStorage.getItem("spa-redirect");e&&(sessionStorage.removeItem("spa-redirect"),window.history.replaceState(null,"",e))})();const a=(e=>{const t=e.match(/^(.*)\/html\/[^/]+\.html$/i);if(t)return t[1];const n=e.replace(/\/index\.html$/i,""),a=l.find(e=>"/"!==e&&n.endsWith(e));return a?n.slice(0,-a.length):n.endsWith("/")?n.slice(0,-1):"/"===n?"":n})(window.location.pathname),s=t=>{const n=(e=>{const t=e.toLowerCase();return t.endsWith("/html/videos.html")||t.endsWith("/videos.html")?"/videos":t.endsWith("/html/games.html")||t.endsWith("/games.html")?"/games":t.endsWith("/html/technical.html")||t.endsWith("/technical.html")?"/technical":t.endsWith("/html/achievements.html")||t.endsWith("/achievements.html")?"/achievements":t.endsWith("/index.html")?"/":null})(t);if(n)return n;const l=(e=>{if(a&&e.startsWith(a))return e.slice(a.length)||"/";return e||"/"})(t);if(!l||"/"===l)return"/";const s=l.endsWith("/")?l.slice(0,-1):l;return e[s]?s:"/"},r=(e,t)=>{const n=`${a||""}${"/"===e?"/":e}`;return t?`${n}${t}`:n},o=new Map,i=async e=>{if(o.has(e))return o.get(e);const t=await fetch(e);if(!t.ok)throw new Error(`Failed to load ${e}`);const n=await t.text();return o.set(e,n),n},c=e=>{document.querySelectorAll(".nav-links a").forEach(t=>{(t.getAttribute("data-route")||"/")===e?t.classList.add("active"):t.classList.remove("active")})},d=(e,t)=>{if(e)try{const n=Number.isFinite(t)?Math.max(0,Math.floor(t)):0;localStorage.setItem(e,String(n))}catch(e){}},m=()=>{if(t.skeletonKey=t.portfolioGrid?`portfolio:${t.currentRoute}`:t.skillsList?`skills:${t.currentRoute}`:null,!t.skeletonKey)return;const e=(e=>{if(!e)return 0;try{const t=localStorage.getItem(e),n=Number.parseInt(t,10);return Number.isFinite(n)&&n>0?n:0}catch(e){return 0}})(t.skeletonKey);e&&t.renderer&&(t.portfolioGrid?(t.renderer.showSkeletons(t.portfolioGrid,e),t.didPrimeSkeletons=!0,t.primedSkeletonCount=e,t.primedSkeletonTarget="portfolio"):t.skillsList&&(t.renderer.showSkeletons(t.skillsList,e),t.didPrimeSkeletons=!0,t.primedSkeletonCount=e,t.primedSkeletonTarget="skills"))},u=e=>new Promise(t=>setTimeout(t,e)),h=(e,t)=>new Promise(n=>{if(!e)return void n({ok:!1,src:"",cached:!1});const l=new Image,a=Date.now();let s=!1;const r=(t,l)=>{if(s)return;s=!0,clearTimeout(o);const r=Date.now()-a;n({ok:t,src:l||e,cached:t&&r<50})},o=setTimeout(()=>r(!1,e),t||3500);l.onload=()=>{const t=e.includes("youtube.com/vi/")&&120===l.naturalWidth&&90===l.naturalHeight;r(!t,e)},l.onerror=()=>r(!1,e),l.src=e}),g=async e=>{let n=!0;const l=e.map(async e=>{const l=await(async e=>{const n=Utils.extractYouTubeID(e.youtube||"");if(n&&""!==n.trim()&&"YOUTUBE_ID_HERE"!==n){const e=["maxresdefault","hqdefault","mqdefault","default"];for(const t of e){const e=`https://img.youtube.com/vi/${n}/${t}.jpg`,l=await h(e,3500);if(l.ok)return{src:e,cached:l.cached}}return{src:`https://img.youtube.com/vi/${n}/default.jpg`,cached:!1}}const l=t.renderer.fixImagePath(e.gallery?.[0]||"");return l?{src:l,cached:(await h(l,3500)).cached}:{src:"",cached:!1}})(e);e.resolvedThumb=l.src,l.cached||(n=!1)});return await Promise.all(l),n},p=(()=>{let e=!1;return()=>{if(e)return;e=!0,document.addEventListener("keydown",e=>{t.secModal&&"flex"===t.secModal.style.display?("ArrowLeft"===e.key&&t.modalManager?.navigateTool(-1),"ArrowRight"===e.key&&t.modalManager?.navigateTool(1),"Escape"===e.key&&t.modalManager?.resetSecModal()):t.modal&&"flex"===t.modal.style.display&&("ArrowLeft"===e.key&&t.modalManager?.navigateItem(-1),"ArrowRight"===e.key&&t.modalManager?.navigateItem(1),"Escape"===e.key&&t.modalManager?.resetModal())}),document.addEventListener("click",e=>{document.querySelectorAll(".custom-select-container, .multi-select-container").forEach(e=>e.classList.remove("open"));const t=e.target.closest("a[data-route]");if(!t)return;if(e.defaultPrevented||0!==e.button||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)return;const n=t.getAttribute("data-route")||"/";e.preventDefault(),w(n,"")}),window.addEventListener("scroll",()=>{document.querySelectorAll(".custom-select-container, .multi-select-container").forEach(e=>e.classList.remove("open"))},{passive:!0});let n=null;window.addEventListener("mousedown",e=>{n=e.target}),window.onclick=function(e){e.target===t.modal&&n===t.modal?t.modalManager?.resetModal():e.target===t.secModal&&n===t.secModal&&t.modalManager?.resetSecModal(),n=null}}})(),f=l=>{if(!t.renderer)return;(()=>{t.allData||(t.allData={});const e=t.currentRoute,l=[];if("/videos"===e&&(t.allData.videos||l.push("videos"),t.allData.skills||l.push("skills")),"/games"===e&&(t.allData.games||l.push("games"),t.allData.skills||l.push("skills")),"/technical"!==e||t.allData.skills||l.push("skills"),"/achievements"===e&&(t.allData.videos||l.push("videos"),t.allData.skills||l.push("skills")),0===l.length)return Promise.resolve({data:t.allData,allCached:!0});let a=!0;return Promise.all(l.map(e=>n.loadSheet(e).then(l=>(t.allData[e]=l.data,l.fromCache||(a=!1),"videos"===e&&(t.filmFestivalAwards=n.buildFilmFestivalAwards(l.data||[])),l.data)))).then(()=>({data:t.allData,allCached:a})).catch(e=>{const n=t.portfolioGrid||t.skillsList;throw n&&(n.innerHTML='<p style="color: #ff6b6b; grid-column: 1/-1; text-align: center; padding: 40px;">Unable to load data. Please check your connection and refresh the page.</p>'),e})})().then(n=>{const a=n.data,r=n.allCached;if(t.routeToken===l){if("/achievements"===t.currentRoute&&((n=>{if(!n||!n.length)return;const l=Array.from(document.querySelectorAll(".achievement-card a")),a=e=>(e||"").toString().toLowerCase().replace(/[^a-z0-9\s]/g," ").replace(/\s+/g," ").trim(),r=new Set;l.forEach(e=>{const t=e.getAttribute("data-project");t&&t.trim()&&r.add(a(t.trim()))});const o=[],i=new Set;l.forEach(e=>{const t=e.getAttribute("data-project");if(t&&t.trim()){const e=a(t.trim());if(!i.has(e)){const t=n.find(t=>a(t.name)===e)||n.find(t=>a(t.name).includes(e))||n.find(t=>e.includes(a(t.name)));t&&(o.push(t),i.add(e))}}}),t.achievementVideos=o,l.forEach(l=>{try{const r=l.getAttribute("data-project"),o=l.getAttribute("href")||"";if(!r&&!(e=>{const t=(e||"").toLowerCase();return t.includes("search=")&&(t.includes("videos.html")||t.includes("/videos"))})(o))return;l.addEventListener("click",l=>{l.preventDefault();let i=r&&r.trim()?r.trim():null;if(!i){const e=new URL(o,window.location.origin).searchParams.get("search")||"";i=decodeURIComponent(e).trim()}const c=a(i),d=n.find(e=>a(e.name)===c)||n.find(e=>a(e.name).includes(c))||n.find(e=>c.includes(a(e.name)));if(d){const e=t.achievementVideos.findIndex(e=>e.name===d.name);t.currentAchievementVideoIndex=e,t.openModalForItem&&t.openModalForItem(d)}else if(o&&"#"!==o){const t=new URL(o,window.location.origin),n=s(t.pathname);e[n]?w(n,t.search):window.location.href=o}}),l.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),l.click())})}catch(e){}})})(a.videos||[]),(()=>{const e=document.getElementById("festival-awards-container");if(!e)return;if(!document.getElementById("award-link-styles")){const e=document.createElement("style");e.id="award-link-styles",e.textContent=".award-video-link:hover { text-decoration: underline !important; }",document.head.appendChild(e)}const n=t.filmFestivalAwards;if(!n||0===Object.keys(n).length)return void(e.innerHTML='<p style="color: #8b949e;">No awards found.</p>');const l=e=>(e||"").toString().toLowerCase().replace(/[^a-z0-9\s]/g," ").replace(/\s+/g," ").trim(),a={};Object.entries(n).forEach(([e,t])=>{Array.isArray(t)&&t.forEach(t=>{a[t.award]||(a[t.award]=[]),a[t.award].push({projectName:e,date:t.date||"",location:t.location||""})})});const s=[],r=new Set;Object.entries(a).forEach(([e,n])=>{n.forEach(e=>{const n=l(e.projectName);if(!r.has(n)){const e=t.allData?.videos||[],a=e.find(e=>l(e.name)===n)||e.find(e=>l(e.name).includes(n))||e.find(e=>n.includes(l(e.name)));a&&(s.push(a),r.add(n))}})}),e.innerHTML="",Object.entries(a).forEach(([t,n])=>{const l=document.createElement("div");l.style.cssText="background: #000000; border: 1px solid #30363d; padding: 12px; border-radius: 6px; display: flex; flex-direction: column;";let a=`<strong style="color: #ffffff; font-size: 0.85rem; text-transform: uppercase; display: block; margin-bottom: 8px;">${t}</strong>`;a+='<div style="display: flex; flex-direction: column; gap: 12px;">',n.forEach((e,t)=>{const n=e.location.split("|").map(e=>e.trim()),l=n[0]||"",s=n[1]||"";a+=`<div style="display: flex; flex-direction: column;">\n                    <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 10px;">\n                        <span class="award-video-link" data-project="${e.projectName}" role="button" tabindex="0" style="color: #58a6ff; text-decoration: none; font-size: 0.9rem; line-height: 1.2; cursor: pointer;">${e.projectName}</span>\n                        <span style="color: #8b949e; font-size: 0.75rem; white-space: nowrap; margin-top: 2px;">${e.date}</span>\n                    </div>\n                    <small style="color: #8b949e; font-size: 0.75rem; line-height: 1.4;">${s}<br/><span style="font-size: 0.65rem; opacity: 0.8;">${l}</span></small>\n                </div>`}),a+="</div>",l.innerHTML=a,e.appendChild(l)}),e._clickHandler&&e.removeEventListener("click",e._clickHandler),e._clickHandler=e=>{const n=e.target.closest(".award-video-link");if(!n)return;e.preventDefault(),e.stopPropagation();const a=n.getAttribute("data-project"),r=l(a),o=s.find(e=>l(e.name)===r)||s.find(e=>l(e.name).includes(r))||s.find(e=>r.includes(l(e.name)));o&&t.modalManager&&(t.achievementVideos=s,t.currentAchievementVideoIndex=s.indexOf(o),t.showModalNavArrows=!0,t.modalManager.openModalForItem(o,"videos",s))},e.addEventListener("click",e._clickHandler)})()),t.portfolioGrid){const e="/games"===t.currentRoute?"games":"videos",n=a[e]||[];if(d(t.skeletonKey,n.length),r||t.didPrimeSkeletons&&"portfolio"===t.primedSkeletonTarget&&t.primedSkeletonCount===n.length||t.renderer.showSkeletons(t.portfolioGrid,n.length),0===n.length&&(t.portfolioGrid.innerHTML=`<p style="color: #8b949e; grid-column: 1/-1; text-align: center; padding: 40px;">No projects found for "${e}".</p>`),n.length>0){const e=Date.now();g(n).then(t=>{const n=Date.now()-e,l=t?0:Math.max(0,150-n);return u(l)}).then(()=>{if(t.routeToken===l)try{t.renderer.renderProjects(n)}catch(e){t.portfolioGrid&&(t.portfolioGrid.innerHTML='<p style="color: #8b949e; grid-column: 1/-1; text-align: center; padding: 40px;">Unable to display projects. Please refresh the page.</p>')}})}}if(t.skillsList){const e=a.skills||[],n="/achievements"===t.currentRoute?e.filter(e=>!0===e.certified).length:e.length;d(t.skeletonKey,n),r||t.didPrimeSkeletons&&"skills"===t.primedSkeletonTarget&&t.primedSkeletonCount===n||t.renderer.showSkeletons(t.skillsList,n);const s=Date.now();(async e=>{let n=!0;const l=e.map(async e=>{const l=t.renderer.fixImagePath(e.icon);e.resolvedIcon=l||"",l&&((await h(l,2500)).cached||(n=!1))});return await Promise.all(l),n})(e).then(e=>{const t=Date.now()-s,n=e?0:Math.max(0,150-t);return u(n)}).then(()=>{t.routeToken===l&&t.renderer.renderSkills(e)})}}}).catch(()=>{})},y=e=>{t.selectedCategories=["all"],t.selectedTools=["all"],t.selectedOrder="desc",t.searchQuery="",t.currentItemCard=null,t.currentGalleryIndex=0,t.currentToolsContext=[],t.currentToolIndex=-1,t.achievementVideos=[],t.currentAchievementVideoIndex=-1,t.didPrimeSkeletons=!1,t.primedSkeletonCount=0,t.primedSkeletonTarget=null,t.skeletonKey=null,t.modal=document.getElementById("infoModal"),t.closeBtn=document.querySelector(".close-button"),t.videoFrame=document.getElementById("modal-video"),t.mediaContainer=document.getElementById("media-container"),t.prevBtn=document.getElementById("modal-prev"),t.nextBtn=document.getElementById("modal-next"),t.secModal=document.getElementById("secondaryModal"),t.secCloseBtn=document.querySelector(".sec-close-button"),t.secPrevBtn=document.getElementById("sec-modal-prev"),t.secNextBtn=document.getElementById("sec-modal-next"),t.skillsList=document.getElementById("skills-list"),t.achievementsList=document.getElementById("achievements-list"),t.portfolioGrid=document.getElementById("portfolio-grid"),t.noResults=document.getElementById("no-results"),t.toolSelectContainer=document.getElementById("tool-select"),t.typeSelectContainer=document.getElementById("type-select"),t.sortSelectContainer=document.getElementById("sort-select"),t.orderSelectContainer=document.getElementById("order-select"),t.searchContainer=document.querySelector(".search-box"),t.searchInput=document.getElementById("portfolio-search"),t.currentRoute=e,t.isSkillsPage=!!t.skillsList,t.isAchievementsPage="/achievements"===e,t.isPortfolioPage=!!t.portfolioGrid,t.selectedSort=t.isSkillsPage?"lastUsed":"date",t.modalManager=new ModalManager(t),t.filterManager=new FilterManager(t),t.controlsManager=new ControlsManager(t),t.renderer=new Renderer(t),t.openModalForItem=(...e)=>t.modalManager.openModalForItem(...e),t.filterCards=()=>t.filterManager.filterCards(),t.filterSkills=()=>t.filterManager.filterSkills(),t.sortCards=()=>t.filterManager.sortCards(),t.sortSkills=()=>t.filterManager.sortSkills(),t.updateTypeFilter=e=>t.controlsManager.updateTypeFilter(e),t.updateToolFilter=e=>t.controlsManager.updateToolFilter(e),t.runFiltering=()=>t.filterManager.runFiltering(),t.controlsManager.initControlSkeletons(),t.controlsManager.renderStaticControls(),m(),t.closeBtn&&(t.closeBtn.onclick=()=>t.modalManager?.resetModal()),t.secCloseBtn&&(t.secCloseBtn.onclick=()=>t.modalManager?.resetSecModal()),t.secPrevBtn&&(t.secPrevBtn.onclick=e=>{e.stopPropagation(),t.modalManager?.navigateTool(-1)}),t.secNextBtn&&(t.secNextBtn.onclick=e=>{e.stopPropagation(),t.modalManager?.navigateTool(1)}),t.prevBtn&&t.prevBtn.addEventListener("click",e=>{e.stopPropagation(),t.modalManager?.navigateItem(-1)}),t.nextBtn&&t.nextBtn.addEventListener("click",e=>{e.stopPropagation(),t.modalManager?.navigateItem(1)});const n=++t.routeToken;f(n)},v=async(n,l,a)=>{const s=e[n]||e["/"],o=document.getElementById("page-root");if(!o)return;const d=r(n,l||"");a&&!1===a.push||window.history.pushState(null,"",d),c(n),document.title=`${s.title} - Benjamin Reynolds`;const m=++t.routeToken;try{const e=await fetch(s.fragment);if(!e.ok)throw new Error(`Failed to load ${s.fragment}`);const l=await e.text();if(t.routeToken!==m)return;o.innerHTML=l,await(async(e,t)=>{const n=Array.from(e.querySelectorAll("[data-fragment]"));if(0!==n.length)for(const e of n){const n=e.getAttribute("data-fragment");if(!n)continue;let l=null;if("controls"===n?l=`html/fragments/controls-${e.getAttribute("data-variant")||("/videos"===t||"/games"===t?"portfolio":"skills")}.html`:"modals"===n?l="html/fragments/modals.html":"no-results"===n&&(l=`html/fragments/no-results-${e.getAttribute("data-variant")||("/videos"===t||"/games"===t?"portfolio":"skills")}.html`),!l)continue;const a=await i(l);e.insertAdjacentHTML("beforebegin",a),e.remove()}})(o,n),y(n)}catch(e){if(t.routeToken!==m)return;o.innerHTML='<div class="page-intro"><h2>Page not found</h2><p>The page could not be loaded.</p></div>',y("/")}},w=(e,t)=>v(e,t,{push:!0});window.navigateTo=w,document.querySelectorAll(".nav-links a[data-route]").forEach(e=>{const t=e.getAttribute("data-route")||"/";e.setAttribute("href",r(t,""))}),c(s(window.location.pathname)),p(),"function"==typeof initializeGlobalSearch&&initializeGlobalSearch(),n.fetchLastUpdated(),n.startTimeUpdates();const b=new URL(window.location.href),k=s(b.pathname);v(k,b.search,{push:!1}),window.addEventListener("popstate",()=>{const e=new URL(window.location.href);v(s(e.pathname),e.search,{push:!1})})});